<!DOCTYPE html>
<html class="no-js" lang="en-us">
<head>
    <!-- Basic Page Needs -->

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:title"       content="The Weekly Challenge - Perl & Raku"/>
    <meta property="og:type"        content="website"/>
    <meta property="og:url"         content="https://perlweeklychallenge.org/"/>
    <meta property="og:image"       content="https://perlweeklychallenge.org/images/about/about.jpg"/>
    <meta property="og:description" content="You do not have to be an expert."/>
    <meta name="twitter:card"       content="summary" />
    <meta name="twitter:image"      content="https://perlweeklychallenge.org/images/about/about.jpg"/>

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

    <meta name="description" content="Laurent Rosenfeld Weekly Review: Challenge - #034.">
    <meta name="author" content="Perl Weekly Challenge Team">
    <meta name="generator" content="Hugo 0.55.5" />

    <!-- Mobile Specific Metas -->
    <meta name="format-detection" content="telephone=no">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Laurent Rosenfeld Weekly Review: Challenge - 034</title>
    <link rel="icon" href="https://perlweeklychallenge.org/images/favicon.ico">

    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css"/>

    <!-- Twitter Bootstrs CSS -->
    <link rel="stylesheet" href="https://perlweeklychallenge.org/plugins/bootstrap/bootstrap.min.css">
    <!-- Ionicons Fonts Css -->
    <link rel="stylesheet" href="https://perlweeklychallenge.org/plugins/ionicons/ionicons.min.css">
    <!-- animate css -->
    <link rel="stylesheet" href="https://perlweeklychallenge.org/plugins/animate-css/animate.css">
    <!-- Hero area slider css-->
    <link rel="stylesheet" href="https://perlweeklychallenge.org/plugins/slider/slider.css">
    <!-- slick slider -->
    <link rel="stylesheet" href="https://perlweeklychallenge.org/plugins/slick/slick.css">
    <!-- Fancybox -->
    <link rel="stylesheet" href="https://perlweeklychallenge.org/plugins/facncybox/jquery.fancybox.css">
    <!-- hover -->
    <link rel="stylesheet" href="https://perlweeklychallenge.org/plugins/hover/hover-min.css">
    <!-- template main css file -->
    
    <link rel="stylesheet" href="https://perlweeklychallenge.org/css/style.min.css" integrity="" media="screen">
    <link rel="stylesheet" href="https://perlweeklychallenge.org/css/main.css">
</head>

<body>

<section class="top-bar animated-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <nav class="navbar navbar-expand-lg navbar-light bg-light">
                    <a class="navbar-brand" href="https://perlweeklychallenge.org/">
                        <img src="https://perlweeklychallenge.org/images/logo.svg" alt="logo">
                    </a>
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navgation" aria-controls="navigation"
                        aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>

                    <div class="collapse navbar-collapse" id="navigation">
                        <ul class="navbar-nav ml-auto">
                            <li class="nav-item">
                                <a class="nav-link" href="https://perlweeklychallenge.org/">Home</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://perlweeklychallenge.org/about">About</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://perlweeklychallenge.org/chart">Chart</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://perlweeklychallenge.org/champions">Champions</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://perlweeklychallenge.org/team">Team</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://perlweeklychallenge.org/challenges">Challenges</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://perlweeklychallenge.org/p5-reviews">Perl/Review</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://perlweeklychallenge.org/p6-reviews">Raku/Review</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://perlweeklychallenge.org/recaps">Recaps</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://perlweeklychallenge.org/blogs">Blogs</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://perlweeklychallenge.org/faq">FAQ</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://perlweeklychallenge.org/contact">Contact</a>
                            </li>
                            
                        </ul>
                    </div>
                </nav>
            </div>
        </div>
    </div>
</section>


<section class="global-page-header">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="block">
                    <h2>Laurent Rosenfeld Weekly Review: Challenge - 034</h2>
                    <div class="portfolio-meta">
                        <span>Sunday, Nov 24, 2019</span>|
                        <span> Tags:
                            Raku
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="single-post">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                
                <div style="text-align: center" class="post-img">
                    <img class="img-fluid" alt="" src="https://perlweeklychallenge.org/images/blog/p6-review-challenge-034.jpg">
                </div>
                
                <div style="text-align: justify" class="post-content">
                    

<hr />

<h1 id="raku-solutions-weekly-review">Raku Solutions Weekly Review</h1>

<hr />

<h2 id="task-1-array-and-hash-slices">Task #1: Array and Hash Slices</h2>

<p>This is derived in part from my <a href="http://blogs.perl.org/users/laurent_r/2019/11/perl-weekly-challenge-34-array-and-hash-slices-and-dispatch-tables.html">blog post</a> made in answer to the <a href="https://perlweeklychallenge.org/blog/perl-weekly-challenge-034/">Week 34 of the Perl Weekly Challenge</a> organized by  <a href="http://blogs.perl.org/users/mohammad_s_anwar/">Mohammad S. Anwar</a> as well as answers made by others to the same challenge.</p>

<p>The challenge, contributed by Dave Cross,  reads as follows:</p>

<p><em>Write a program that demonstrates using hash slices and/or array slices.</em></p>

<p>Slices are a way to access several values of an array or of a hash in one statement, by using multiple subscripts or keys.</p>

<h2 id="my-solutions">My solutions</h2>

<p>If you have an <code>@array</code> containing for example some successive integers, you can obtain several values from it with the following syntax: <code>@array[3, 7, 2]</code> or even <code>@array[2..7]</code>. This is an example under the REPL:</p>

<pre><code>&gt; my @array = 0..10;
[0 1 2 3 4 5 6 7 8 9 10]
&gt; say @array[3, 7, 3]
(3 7 3)
&gt; say @array[2..7]
(2 3 4 5 6 7)
</code></pre>

<p>And you can do just about the same with a hash to obtain a bunch of values. Array and hash slices may also be used as <em>l-values</em>, i.e. on the left-hand side of an assignment, to populate a new array or a new hash.</p>

<pre><code class="language-Perl6">use v6;

my @array = 0..10;
my $count = 0;
my %hash  = map {$_ =&gt; ++$count}, 'a'..'j';

say &quot;Array slice :  @array[3..7]&quot;;
say &quot;Hash slice 1: &quot;, join ' ', %hash{'b', 'd', 'c'};
say &quot;Hash slice 2: &quot;, join ' ', %hash{'b'..'d'};
say &quot;Hash slice 3: &quot;, join ' ', %hash&lt;b c d&gt;;

# Array slice a l-value
my @new-array = (1, 2);
@new-array[2, 3] = @array[6, 7];
say &quot;New array: &quot;, @new-array;
# Hash slice as l-value:
my @keys = qw/c d e/;
my %new-hash;
%new-hash{@keys} = %hash{@keys};
say &quot;New hash: &quot;, %new-hash;
</code></pre>

<p>This program produces the following output:</p>

<pre><code>$ perl6 hash_slices.p6
Array slice :  3 4 5 6 7
Hash slice 1: 2 4 3
Hash slice 2: 2 3 4
Hash slice 3: 2 3 4
New array: [1 2 6 7]
New hash: {c =&gt; 3, d =&gt; 4, e =&gt; 5}
</code></pre>

<h2 id="alternative-solutions">Alternative Solutions</h2>

<p>Maybe it&rsquo;s me missing out something, but I&rsquo;m a bit disappointed by several of the solutions, which is quite surprising for such a simple challenge. Several solutions just don&rsquo;t really fit the bill.</p>

<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-034/arne-sommer/perl6/ch-1.p6">Arne Sommer</a> provided a few nice examples of array slices, plus one example of a hash slice. Please run Arne&rsquo;s code to understand anything that isn&rsquo;t obvious to you.</p>

<pre><code class="language-Perl6">my @values = &lt;zero one twice thrice four fifth VI seventh acht nine X&gt;;

say @values[0 .. 10];
say @values[0 .. 12];
say @values[10 ... 0];
say @values[7, 4, 1];

my %values = @values.antipairs;

say %values&lt;zero&gt;;
say %values&lt;zero VI nine&gt;;
</code></pre>

<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-034/kevin-colyer/perl6/ch-1.p6">Kevin Colyer</a> contributed a quite long script, implementing an adventure game and demonstrating both topics of week # 34 challenge, dispatch tables and hash slices. I originally did not see the hash slices and mistakenly reported that. Kevin, please excuse me for this initial error. Kevin&rsquo;s script has two hash slices on his dispatch table, on lines 228 and 235;</p>

<pre><code class="language-Perl6">    # NOTE dispatch tables AND hash slices!
    if $thing eq &quot;bubblyflask&quot; {
        %dispatch{&quot;n&quot;,&quot;north&quot;, &quot;e&quot;,&quot;east&quot;,&quot;s&quot;,&quot;south&quot;,&quot;w&quot;,&quot;west&quot;} = (&amp;east, &amp;east, &amp;south, &amp;south, &amp;west, &amp;west, &amp;north, &amp;north);
        %flags&lt;confused&gt;=True;
        return increase_score(1) ~ &quot;The bubbly liquid tastes of melon and treacle and it goes straight to your head in seconds. You feel dizzy and confused, yet pleasantly happy.&quot;;
    }
    if $thing eq &quot;fizzyflask&quot; {
        %dispatch{&quot;n&quot;,&quot;north&quot;, &quot;e&quot;,&quot;east&quot;,&quot;s&quot;,&quot;south&quot;,&quot;w&quot;,&quot;west&quot;} = (&amp;north, &amp;north, &amp;east, &amp;east, &amp;south, &amp;south, &amp;west, &amp;west);
        %flags&lt;confused&gt;=False;
        return increase_score(1) ~ &quot;The vile taste of the fizzy liquid sobers you right up. The room swims back into focus.&quot;;
    }
</code></pre>

<p>Also note that Kevin&rsquo;s script is the only one besides mine which uses hash slices as <em>l-values</em> (i.e. on the left-hand side of an assignment).</p>

<p>Again, sorry, Kevin, for this initial mistake.</p>

<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-034/simon-proctor/perl6/ch-1.p6">Simon Proctor</a> suggested a quite interesting program that illustrates various relatively advanced features of Raku including, but only marginally, slices, so that the slice features are a bit blurred by the other features. I extracted from his code two examples illustrating the slice feature:</p>

<pre><code class="language-Perl6"># Making an array from a Sequence using a slice (^100 is the Range 0..100)
my @fibto100 = (1,1,*+*...*)[^100];

# Use a simple slice to get the first 5 Fibonacci numbers
say &quot;First five Fibonacci numbers {@fibto100[^5].join(&quot;,&quot;)}&quot;;
</code></pre>

<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-034/ulrich-rieke/perl6/ch-1.p6">Ulrich Rieke</a> also wrote a program that doesn&rsquo;t really convince me in terms of really illustrating hash slices: using <code>grep</code> and <code>:delete</code> is a good way to filter items of a hash, but that has little to do with slices.  His array slice example is much more convincing:</p>

<pre><code class="language-Perl6">#...and of array slices :
my @random_DNA_bases  ;
for (1..63 ) {
  @random_DNA_bases.push( &lt;A C T G&gt;.pick( 1 )) ;
}
my @tripletstarts = @random_DNA_bases[0,3,6...*] ;
say &quot;...and the corresponding triplet starts:&quot; ;
@tripletstarts.say ;
</code></pre>

<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-034/jaldhar-h-vyas/perl6/ch-1.p6">Jaldhar H. Vyas</a> implemented a recursive binary search algorithm that convincingly uses array slices to provide the arguments to the recursive subroutine calls:</p>

<pre><code class="language-Perl6">sub binarySearch(@haystack,  $needle) {
    if @haystack.elems {
        my $mid = (@haystack.elems / 2).Int;

        if $needle eq @haystack[$mid] {
            return True;
        }

        if $needle gt @haystack[$mid] {
            return binarySearch(@haystack[$mid + 1 .. *], $needle);
        }

        return binarySearch(@haystack[0 .. $mid - 1], $needle);
    }
    return False;
}
</code></pre>

<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-034/noud/perl6/ch-1.p6">Noud</a> provided a program demonstrating simple hash slices and various array slices:</p>

<pre><code class="language-Perl6"># Hash slices
#
# The idea behind hash slices is that you can assign multiple keys at the same
# time with a hash slice.
# Also see: https://docs.perl6.org/language/hashmap#Hash_slices

my %h;
%h&lt;a b c d&gt; = ^4;

say %h;
say %h&lt;a c&gt;;


# Slice indexing
#
# Similar, we can use slicing for extracting slices from an array.
# Also see: https://docs.perl6.org/language/list#Range_as_slice

my @a = ^10;

say @a[0..2];
say @a[^2];
say @a[0..*];
say @a[0..Inf-1];
say @a[0..*-1];
say @a[0..^*-1];
say @a[0..^*/2];
</code></pre>

<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-034/javier-luque/perl6/ch-1.p6">Javier Luque</a> made a very simple program illustrating well the central feature of array and hash slices:</p>

<pre><code class="language-Perl6">sub MAIN () {
    my @array = (0..Inf);
    my %hash = ( a =&gt; 1, b =&gt; 2, c =&gt; 3, d =&gt; 4 );
    say 'Array slice: ' ~ @array[0..5];
    say 'Hash slice: ' ~ %hash{'a','b'};
}
</code></pre>

<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-034/roger-bell-west/perl6/ch-1.p6">Roger Bell West</a> suggested a program illustrating array slices:</p>

<pre><code class="language-Perl6">my @data=map {rand}, (1..10);
my @ma=map {sum(@data[$_-1..$_+1])/3}, (1..@data.end-1);
unshift @ma,NaN;
push @ma,NaN;
my @out=map {[@data[$_],@ma[$_]]}, (0..@data.end);
say @out.perl;
</code></pre>

<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-034/ruben-westerberg/perl6/ch-1.p6">Ruben Westerberg</a> made a simple no-frills program illustrating very well array and hash slices:</p>

<pre><code class="language-Perl6">#Demonstate array and hash slicing
my @array=(0,1,2,3,4,5,6,7,8,9);
my %hash=(a=&gt;0, b=&gt;1, c=&gt;2, e=&gt;3);
say &quot;Original Array: \n&quot;, @array;
say &quot;Original Hash \n&quot;,%hash;

say &quot;Slicing Array with a range [0..3]: &quot;;
say @array[0..3];

say &quot;Slicing Array with duplicate index [0,0]: &quot;;
say @array[0,0];

say 'Slicing hash into another hash %hash{qw&lt;a b&gt;}:kv.hash : ';
say %hash{qw&lt;a b&gt;}:kv.hash;

say 'Slicing hash in to value array %hash{qw&lt;a b&gt;}: ';
say %hash{qw&lt;a b&gt;};
</code></pre>

<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-034/steven-wilson/perl6/ch-1.p6">Steven Wilson</a>, a new member of the challengers team, also provided a simple program illustrating array slices:</p>

<pre><code class="language-Perl6">my @numbers = &lt;10 20 30 40 50 60 70 80 90&gt;;
my ( $first_number, $last_number ) = @numbers[0, *-1];
put &quot;First 4 numbers in the array are: @numbers[0 .. 3]&quot;;
</code></pre>

<h2 id="task-2-dispatch-tables">Task #2: Dispatch Tables</h2>

<p>This is derived in part from my <a href="http://blogs.perl.org/users/laurent_r/2019/11/perl-weekly-challenge-34-array-and-hash-slices-and-dispatch-tables.html">blog post</a> made in answer to the <a href="https://perlweeklychallenge.org/blog/perl-weekly-challenge-034/">Week 34 of the Perl Weekly Challenge</a> organized by  <a href="http://blogs.perl.org/users/mohammad_s_anwar/">Mohammad S. Anwar</a> as well as answers made by others to the same challenge.</p>

<p>The challenge, contributed by Dave Cross,  reads as follows:</p>

<p><em>Write a program that demonstrates a dispatch table.</em></p>

<p>A dispatch table is a table (e.g. an array or more commonly a hash) of subroutine references or other code objects.</p>

<h2 id="my-solution">My Solution</h2>

<p>For this task, we want to do a bit more than simply demonstrate the syntax: we will try to do something (moderately) useful with it.</p>

<p>Suppose we have a text file and want to feed each word from the file into 26 files (one per letter of the alphabet) depending on the first letter of the word. This could be done with a monstrous <code>if ... elsif ... else</code> or <code>given ... when</code> construct, or we could use a dispatch table, in this case a hash containing for each letter a code reference printing the word into the proper file. As we will see, this produces much shorter and simpler code. We will even use a dynamic dispatch table, i.e. only create the hash entries (and files) that are needed with the input file.</p>

<p>we first write a <code>function_builder</code> subroutine that acts as a function factory. It receives a letter as a parameter, creates a file name for that letter, opens the corresponding file in write mode, and it returns an anonymous code block (actually a closure) that writes its argument to the file handle. This anonymous code block will be stored into the dispatch table.</p>

<p>In the <code>MAIN</code> subroutine , the program reads the words of the input file, fold them to lower case, and finds the first character of each such word. To avoid file name problems with special characters, we only keep words starting with a letter. If the dispatch table has no entry yet for this letter, the program calls <code>function_builder</code> subroutine to open the proper file and stores the code reference returned by that subroutine in the dispatch table. Finally, the program calls the code reference stored in the dispatch table for word&rsquo;s first letter.</p>

<pre><code class="language-Perl6">use v6;

sub function_builder (Str $letter) {
    my $file_name = &quot;letter_$letter.txt&quot;;
    my $fh = open &quot;./$file_name&quot;, :w;
    return { $fh.say($^a) }
}

multi sub MAIN (Str $file where *.IO.f) {
    my %dispatch;
    for $file.IO.words.map({.lc}) -&gt; $word {
        my $letter = substr $word, 0, 1;
        next if $letter !~~ /^&lt;[a..z]&gt;/;
        %dispatch{$letter} = function_builder $letter unless defined %dispatch{$letter};
        %dispatch{$letter}($word);
    }
}
</code></pre>

<p>Running the program and passing it the <code>hash_slices.p6</code> file (the <a href="https://github.com/LaurentRosenfeld/Perl-6-Miscellaneous/blob/master/Challenges-in-Perl6/Array-and-hash-slices.md">script</a> of task # 1 of this week) produced the following files in the default directory:</p>

<pre><code>-rwxr-xr-x  1 Laurent Aucun       5 11 nov.  18:26  letter_u.txt
-rwxr-xr-x  1 Laurent Aucun       5 11 nov.  18:26  letter_v.txt
-rwxr-xr-x  1 Laurent Aucun       3 11 nov.  18:26  letter_c.txt
-rwxr-xr-x  1 Laurent Aucun       6 11 nov.  18:26  letter_q.txt
-rwxr-xr-x  1 Laurent Aucun       5 11 nov.  18:26  letter_e.txt
-rwxr-xr-x  1 Laurent Aucun      72 11 nov.  18:26  letter_s.txt
-rwxr-xr-x  1 Laurent Aucun      29 11 nov.  18:26  letter_m.txt
-rwxr-xr-x  1 Laurent Aucun      18 11 nov.  18:26  letter_j.txt
-rwxr-xr-x  1 Laurent Aucun      19 11 nov.  18:26  letter_l.txt
-rwxr-xr-x  1 Laurent Aucun      13 11 nov.  18:26  letter_h.txt
-rwxr-xr-x  1 Laurent Aucun       8 11 nov.  18:26  letter_d.txt
-rwxr-xr-x  1 Laurent Aucun      22 11 nov.  18:26  letter_a.txt
</code></pre>

<p>This is the file generated for letter &ldquo;a&rdquo;:</p>

<pre><code>$ cat letter_a.txt
array
a
array:
as
</code></pre>

<h2 id="alternative-solutions-1">Alternative Solutions</h2>

<p>My initial idea, when I started to consider this challenge, was to implement some form of an arithmetic calculator. I&rsquo;m happy that I chose something else, as not less than three challengers chose to implement such an arithmetic calculator.</p>

<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-034/arne-sommer/perl6/ch-2.p6">Arne Sommer</a> implemented a program with a user interface in which the user is prompted to enter a command and the program executes the subroutine associated with that command in a <code>%dispatch</code> hash:</p>

<pre><code class="language-Perl6">my $value = 0;
my %dispatch =
(
  q      =&gt; &amp;last,
  quit   =&gt; &amp;last,
  d      =&gt; &amp;double,
  double =&gt; &amp;double,
  h      =&gt; &amp;half,
  half   =&gt; &amp;half,
  c      =&gt; &amp;clear,
  clear  =&gt; &amp;clear,
  help   =&gt; &amp;help,
);
loop
{
  my $command = prompt &quot;[$value]: &quot;;

  if %dispatch{$command}     { %dispatch{$command}(); }
  elsif $command ~~ /^(\d)$/ { set($0.Int); }
}
sub last
{
  exit;
}
sub double
{
  $value *= 2;
}
sub half
{
  $value /= 2;
}
sub clear
{
  $value = 0;
}
sub set ($new)
{
  $value = $new;
}
sub help
{
  say &quot;Please consult a doctor.&quot;;
}
</code></pre>

<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-034/kevin-colyer/perl6/ch-2.p6">Kevfin Colyer</a> also implemented a user interface for a game in which the user is prompted to enter a command and the program executes the subroutine associated with that command in a <code>%dispatch</code> hash:</p>

<pre><code class="language-Perl6">my %dispatch =
    debug =&gt; &amp;_debug,
    test =&gt; &amp;_test,

    save =&gt; &amp;_savegame,

    help =&gt; &amp;help,
    h =&gt; &amp;help,
    north =&gt; &amp;north,
    n =&gt; &amp;north,
    south =&gt; &amp;south,
    s =&gt; &amp;south,
    east =&gt; &amp;east,
    e =&gt; &amp;east,
    west =&gt; &amp;west,
    w =&gt; &amp;west,
    quit =&gt; &amp;quit,
    q =&gt; &amp;quit,
    examine =&gt; &amp;examine,
    x =&gt; &amp;examine,
    look =&gt; &amp;look,
    l =&gt; &amp;look,
    score =&gt; &amp;score,
    inventory =&gt; &amp;inventory,
    i =&gt; &amp;inventory,
    get =&gt; &amp;get,
    take =&gt; &amp;get,
    drop =&gt; &amp;drop,
    drink =&gt; &amp;drink,
;
</code></pre>

<p>Kevin then provides the code for all the subroutines listed in the dispatch table. I&rsquo;ll quote only a few of them:</p>

<pre><code class="language-Perl6">sub score($v,$a,$n) { &quot;You have scored {%flags&lt;score&gt;} out of a possible {%flags&lt;max_score&gt;} points.&quot; };

sub _debug($v,$a,$n) { %flags&lt;_debug&gt;= $n~~ &quot;on&quot; ?? True !! False; &quot;debug on: &quot; ~ %flags&lt;_debug&gt; };

sub _test($v,$a,$n) { &quot;testing here!&quot; };

sub _savegame($v,$a,$n) {my $f= &quot;save.game&quot;; $f.IO.spurt: { flags =&gt; %flags, objects =&gt; %objects, rooms =&gt; %rooms }.perl; &quot;Saved to file [$f]&quot; };
</code></pre>

<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-034/noud/perl6/ch-2.p6">Noud</a> suggested a simple <code>%dispatch</code> table with three items:</p>

<pre><code class="language-Perl6">sub hello() {
    &quot;Hello&quot;;
}
sub fib($n) {
    if ($n &lt; 1) {
        return 0;
    }
    if ($n == 1) {
        return 1;
    }
    return fib($n - 1) + fib($n - 2);
}
my %dispatch = (
    hello =&gt; &amp;hello,
    world =&gt; sub { &quot;World&quot;; },
    fib =&gt; &amp;fib
);
say %dispatch{&quot;hello&quot;}() ~ &quot; &quot; ~ %dispatch{&quot;world&quot;}();
say %dispatch{&quot;fib&quot;}(20);
</code></pre>

<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-034/simon-proctor/perl6/ch-2.p6">Simon Proctor</a> contributed a program that can be launched with two parameters, an action and an integer value. As you might have guessed, the authorized actions are stored in a <code>%commands</code> dispatch table. His program then performs action required by the first argument on the second argument:</p>

<pre><code class="language-Perl6"># Possible actions
sub doubler ( Int $x ) { $x * 2 }
sub halver ( Int $x ) { $x / 2 }
sub squarer ( Int $x ) { $x * $x }
sub reverser ( Int $x ) { $x.flip.Int }
sub zeroer ( Int $x ) { 0 }

# Despatch table
my %commands = (
    &quot;double&quot;  =&gt; &amp;doubler,
    &quot;halve&quot;   =&gt; &amp;halver,
    &quot;square&quot;  =&gt; &amp;squarer,
    &quot;reverse&quot; =&gt; &amp;reverser,
    &quot;zero&quot;    =&gt; &amp;zeroer,
);

#| Help
multi sub MAIN( Bool :h(:$help) where so * ) {
    say $*USAGE;
}

#| Use despatch table to run the given command
multi sub MAIN(
    Str $command where { %commands{$command}:exists }, #= Valid command from double, halve, square, reverse, zero
    Int() $value #= Value to apply command to
) {
    say &quot;{$command}( {$value} ) =&gt; {%commands{$command}($value)}&quot;;
}
</code></pre>

<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-034/ulrich-rieke/perl6/ch-2.p6">Ulrich Rieke</a> provided a program with a user interface in which the user is prompted to enter a code for an arithmetic operation and two numbers. The program then uses a <code>%dispatcher</code> table to perform the requested operation:</p>

<pre><code class="language-Perl6">#demonstrating the use of a dispatcher, without much of input validation

sub add( Numeric $a , Numeric $b ) {
  return $a + $b ;
}

sub subtract( Numeric $a , Numeric $b ) {
  return $a - $b ;
}

sub multiply( Numeric $a , Numeric $b ) {
  return $a * $b ;
}

sub divide( Numeric $a , Numeric $b ) {
  return $a / $b ;
}

say &quot;Enter a number from 1 to 4 to indicate what you want to do!&quot; ;
say &quot;1) add&quot; ;
say &quot;2) subtract&quot; ;
say &quot;3) multiply&quot; ;
say &quot;4) divide&quot; ;
my $answer = $*IN.get ;
my $choice = $answer.substr(0, 1 ) ;
while ( +$choice &lt; 1 || +$choice &gt; 4 )  {
  say &quot;Enter a number from 1 to 4 to indicate what you want to do!&quot; ;
  say &quot;1) add&quot; ;
  say &quot;2) subtract&quot; ;
  say &quot;3) multiply&quot; ;
  say &quot;4) divide&quot; ;
  $answer = $*IN.get ;
  $choice = $answer.substr(0, 1 ) ;
}
say &quot;Enter your 2 operands: ( 2 in a row separated by spaces )&quot; ;
my $numberline = $*IN.get ;
my @numbers = $numberline.split(/\s+/) ;
while @numbers.elems &lt; 2 {
  say &quot;Enter your 2 operands: (2 in a row separated by spaces)&quot; ;
  my $numberline = $*IN.get ;
  my @numbers = $numberline.split(/\s+/) ;
}
my %dispatcher = '1' =&gt; &amp;add , '2' =&gt; &amp;subtract , '3' =&gt; &amp;multiply,
  '4' =&gt; &amp;divide ;
if ( 1 &lt;= +$choice &lt;= 3 ) {
  say &quot;The result is {%dispatcher{$choice}(+@numbers[0] , +@numbers[1]) }!&quot; ;
}
if (+$choice == 4 ) {
  if (+@numbers[1] == 0) {
      say &quot;Illegal division by 0!&quot; ;
  }
  else {
      say &quot;The result is {%dispatcher{'4'}(+@numbers[0] , +@numbers[1]) }!&quot; ;
  }
}
</code></pre>

<p>Note that since the user is prompted to enter an integer code for the arithmetic operation, this is a case where the dispatch table could have been implemented as a simple array instead of a hash.</p>

<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-034/javier-luque/perl6/ch-2.p6">Javier Luque</a> also used a dispatch table to implement arithmetic operations:</p>

<pre><code class="language-Perl6">sub MAIN () {
    my %dispatch_table = (
        '+' =&gt; &amp;add,
        '-' =&gt; &amp;subtract,
        'x' =&gt; sub ($a , $b) { $a * $b },
        '/' =&gt; -&gt; $a , $b { $a / $b },
    );

    my @equations = ('2 + 2', '10 - 4', '3 x 3', '25 / 5');
    for (@equations) -&gt; $equation {
        ($equation ~~ /^(\d+)\s*(\+|\-|x|\/)\s*(\d+)$/);
        say $equation ~ ' = ' ~
            %dispatch_table{$1}($0, $2);
    }
}

sub add(Num() $a, Num() $b)      { return ($a + $b); }
sub subtract(Num() $a, Num() $b) { return ($a - $b); }
</code></pre>

<p>Note that Javier is the only challenger who used an anonymous subroutine reference and an anonymous code block defined directly in the dispatch table (for the multiplication and the division), although Ruben Westerberg did something vaguely similar. This is an interesting syntax, as it tends to make the code simpler and more concise (at least when the subroutine is simple enough).</p>

<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-034/roger-bell-west/perl6/ch-2.p6">Roger Bell West</a> also implemented an arithmetic calculator, but in the form of a stack machine. His dispatch table looks like this:</p>

<pre><code class="language-Perl6">my %op=(
  add =&gt; &amp;add,
  '+' =&gt; &amp;add,
  sub =&gt; &amp;sub,
  '-' =&gt; &amp;sub,
  mul =&gt; &amp;mul,
  '*' =&gt; &amp;mul,
  div =&gt; &amp;div,
  '/' =&gt; &amp;div,
  neg =&gt; &amp;neg,
  dup =&gt; &amp;dup,
  pop =&gt; &amp;pop,
  exch =&gt; &amp;exch,
    );
</code></pre>

<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-034/jaldhar-h-vyas/perl6/ch-2.p6">Jaldhar H. Vyas</a> implemented a rock, paper, and scissors game simulation:</p>

<pre><code class="language-Perl6">my @choices = ( &amp;chose_paper, &amp;chose_scissors, &amp;chose_rock );

my @outcomes = (
    (    &amp;draw,              &amp;scissors_loss,     &amp;paper_win,    ),
    (    &amp;scissors_win,      &amp;draw,              &amp;rock_loss,    ),
    (    &amp;paper_loss,        &amp;rock_win,          &amp;draw,         )
);

my @winners = ( &amp;winner_A, &amp;winner_B );

sub chose_paper($chooser) {
    say &quot;$chooser chose Paper.&quot;;
}
sub chose_scissors($chooser) {
    say &quot;$chooser chose Scissors.&quot;;
}
sub chose_rock($chooser) {
    say &quot;$chooser chose Rock.&quot;;
}
sub paper_win {
    say &quot;Paper covers Rock.  &quot;;
    @winners[0]();
}
sub paper_loss {
    say &quot;Paper covers Rock.  &quot;;
    @winners[1]();
}
sub scissors_win {
    say &quot;Scissors cuts Paper.  &quot;;
    @winners[0]();
}
sub scissors_loss {
    say &quot;Scissors cuts Paper.  &quot;;
    @winners[1]();
}
sub rock_win {
    say &quot;Rock smashes Scissors.  &quot;;
    @winners[0]();
}
sub rock_loss {
    say &quot;Rock smashes Scissors.  &quot;;
    @winners[1]();
}
sub draw {
    say &quot;It's a draw.&quot;;
}
sub winner_A {
    say &quot;A wins.&quot;;
}
sub winner_B {
    say &quot;B wins.&quot;;
}
sub MAIN() {
    my $achoice = (0..2).roll;
    my $bchoice = (0..2).roll;

    @choices[$achoice]('A');
    @choices[$bchoice]('B');

    @outcomes[$achoice][$bchoice]();
}
</code></pre>

<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-034/ruben-westerberg/perl6/ch-2.p6">Ruben Westerberg</a> implemented an array of 10 anonymous subroutines called randomly:</p>

<pre><code class="language-Perl6">my @dispatch= (1..10).map( { my $i=$_;sub { templateSub($i)}});

@dispatch[@dispatch.elems.rand.Int]() for @dispatch;

sub templateSub($i) {
    put &quot;Hello from function $i&quot;;
}
</code></pre>

<h2 id="see-also">SEE ALSO</h2>

<p>Three blog posts this time:</p>

<ul>
<li>Arne Sommer: <a href="https://raku-musings.com/sliced-dispatch.html">https://raku-musings.com/sliced-dispatch.html</a>;</li>
<li>Jaldhar H. Vyas: <a href="https://www.braincells.com/perl/2019/11/perl_weekly_challenge_week_34.html">https://www.braincells.com/perl/2019/11/perl_weekly_challenge_week_34.html</a>;</li>
<li>Javier Luque: <a href="https://perlchallenges.wordpress.com/2019/11/11/perl-weekly-challenge-034/">https://perlchallenges.wordpress.com/2019/11/11/perl-weekly-challenge-034/</a></li>
</ul>

<h2 id="wrapping-up">Wrapping up</h2>

<p>Please let me know if I forgot any of the challengers or if you think my explanation of your code misses something important (send me an e-mail or just raise an issue against this GitHub page).</p>

                </div>
            </div>
        </div>
    </div>
</section>


<!-- Call To Action Section Start -->
<section id="call-to-action">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="block">
                    <h2 class="title wow fadeInDown" data-wow-delay=".3s" data-wow-duration="500ms">SO WHAT DO YOU THINK ?</h2>
                    <p class="wow fadeInDown" data-wow-delay=".5s" data-wow-duration="500ms">If you have any suggestions or ideas then please do share with us.</p>
                    <a href="/contact" class="btn btn-default btn-contact wow fadeInDown" data-wow-delay=".7s" data-wow-duration="500ms">Contact with me</a>
                </div>
            </div>

        </div>
    </div>
</section>
<!-- Call To Action Section End -->



<!-- Footer Section Start -->
<footer id="footer">
    <div class="container">
        <div class="row content-justify-between">
            <div class="col-md-8 col-12 text-center text-lg-left text-md-left">
                <p class="copyright">Copyright:
                    <span>
                        <script>document.write(new Date().getFullYear())</script>
                    </span> PerlWeeklyChallenge. Theme Design and Developed by
                    <a href="http://www.Themefisher.com" target="_blank">Themefisher</a>.
                </p>
            </div>
            <div class="col-md-4 col-12">
                <!-- Social Media -->
                <ul class="social text-center text-md-right text-lg-right">
                    <li>
                        <a href="https://twitter.com/PerlWChallenge" class="twitter" target="_blank" title="Follow us">
                            <i class="ion-social-twitter"></i>
                        </a>
                    </li>
                    <li>
                        <a href="/rss.xml" class="rss" target="_blank" title="RSS Feed">
                            <i class="ion-social-rss"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://www.nomtimes.co.uk/site/shop.do?cref=PerlBooks" title="Free Perl Books" target="_blank">
                            <img src="/images/NomTimes.jpg" style="width:22px; height: 18px;" alt=""/>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</footer>
<!-- footer section end -->

<!-- jquery -->
<script src="https://perlweeklychallenge.org/plugins/jQurey/jquery.min.js"></script>
<!-- Form Validation -->
<script src="https://perlweeklychallenge.org/plugins/form-validation/jquery.form.js"></script>
<script src="https://perlweeklychallenge.org/plugins/form-validation/jquery.validate.min.js"></script>
<!-- slick slider -->
<script src="https://perlweeklychallenge.org/plugins/slick/slick.min.js"></script>
<!-- bootstrap js -->
<script src="https://perlweeklychallenge.org/plugins/bootstrap/bootstrap.min.js"></script>
<!-- chart js -->
<script src="https://perlweeklychallenge.org/plugins/chart/highstock.js"></script>
<script src="https://perlweeklychallenge.org/plugins/chart/drilldown.js"></script>
<script src="https://perlweeklychallenge.org/plugins/chart/data.js"></script>
<script src="https://perlweeklychallenge.org/plugins/chart/chart.js"></script>
<!-- wow js -->
<script src="https://perlweeklychallenge.org/plugins/wow-js/wow.min.js"></script>
<!-- slider js -->
<script src="https://perlweeklychallenge.org/plugins/slider/slider.js"></script>
<!-- Fancybox -->
<script src="https://perlweeklychallenge.org/plugins/facncybox/jquery.fancybox.js"></script>
<!-- template main js -->

<script src="https://perlweeklychallenge.org/js/script.min.js"></script>
<!-- google analitycs -->
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-136524905-1', 'auto');
    ga('send', 'pageview');
</script>
</body>

</html>

